---
import Layout from '@layouts/Layout.astro';
import BookDetailsFragment from '@pages/fragments/BookDetails/[id].astro';
import { metadata } from '@config/metadata.js';

const pageTitle = `Book Details â€” ${metadata.name || "Juan's Favorites"}`;
const pageDescription = `Details for a selected book from ${metadata.name || "Juan's Favorites"}.`;

// For static site generation, getStaticPaths is required for dynamic routing
import type { GetStaticPaths } from 'astro';
import booksData from '@data/myFavBooks.json';

// Generate static paths for all books
export const getStaticPaths = (() => {
  try {
    if (Array.isArray(booksData)) {
      return booksData.map(book => ({
        params: { id: book.api_id || String(book._id) },
      }));
    }
    return [];
  } catch (error) {
    console.error("Error in getStaticPaths for books:", error);
    return []; // Fallback to empty paths if error or no data
  }
}) satisfies GetStaticPaths;
---

<Layout title={pageTitle} description={pageDescription}>
  <BookDetailsFragment />
</Layout>
